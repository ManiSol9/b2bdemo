(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{232:function(e,t,a){e.exports=a(428)},237:function(e,t,a){},256:function(e,t,a){},422:function(e,t,a){},423:function(e,t,a){},428:function(e,t,a){"use strict";a.r(t);var n=a(0),l=a.n(n),i=a(7),s=a.n(i),c=(a(237),a(59)),o=a(60),r=a(67),m=a(61),h=a(66),d=a(48),u=a(137),v=a(68),p=a(37),E=a.n(p),f=a(432),b=a(435),N=a(433),g=a(434),C=(a(256),a(152),N.a.Search),k=function(e){function t(){var e;return Object(c.a)(this,t),(e=Object(r.a)(this,Object(m.a)(t).call(this))).fetchAccessToken=function(){E()({method:"get",url:"https://dhlcp-b2b-externaluserappservice.azurewebsites.net/api/getToken",headers:{"content-type":"application/x-www-form-urlencoded",accept:"application/json","Access-Control-Allow-Origin":"*","Access-Control-Allow-Methods":"GET","Access-Control-Allow-Credentials":!0}}).then(function(t){console.log(t),e.setState({access_token:t.data.output.access_token},function(){e.fetchDetails()})}).catch(function(e){})},e.showModal=function(t,a){"update"==a?e.setState({inviteModel:0,visible:!0,name:t.displayName,mail:t.mail,phone:t.mobilePhone,lastname:t.surname,id:t.id}):e.setState({inviteModel:1,visible:!0})},e.handleOk=function(t){console.log(t),e.setState({visible:!1})},e.handleCancel=function(t){console.log(t),e.setState({visible:!1})},e.fetchDetails=function(){E()({method:"get",url:"https://graph.microsoft.com/v1.0/users",headers:{Authorization:"Bearer "+e.state.access_token,"Content-Type":"application/json"}}).then(function(t){console.log(t.data.odata.nextLink);var a=t.data.value;e.setState({users:a,search:""})}).catch(function(e){console.log(e),401==e.response.status||alert("Something went Problem!, Please try again later")})},e.handleChange=function(t){var a=t.target,n=a.name,l=a.value;"search"===n&&e.setState({search:l}),"name"===n&&e.setState({name:l}),"mail"===n&&e.setState({mail:l}),"phone"===n&&e.setState({phone:l}),"lastname"===n&&e.setState({lastname:l}),"invitename"===n&&e.setState({inviteDisplayName:l}),"invitemail"===n&&e.setState({inviteUserEmail:l})},e.handleSubmit=function(t){e.setState({search:t});var a="?$filter=startswith(mail, '"+t+"')";E()({method:"get",url:"https://graph.microsoft.com/v1.0/users"+a,headers:{Authorization:"Bearer "+e.state.access_token,"Content-Type":"application/json"}}).then(function(t){console.log(t);var a=t.data.value;[].push(a),e.setState({users:a})}).catch(function(e){console.log(e)})},e.handleUpdate=function(t){E()({method:"PATCH",url:"https://graph.microsoft.com/v1.0/users/"+e.state.id,headers:{Authorization:"Bearer "+e.state.access_token,"Content-Type":"application/json"},data:{accountEnabled:!0,givenName:e.state.lastname,mobilePhone:e.state.phone,displayName:e.state.firstname}}).then(function(e){console.log(e),alert("Updated Suucessfully")}).catch(function(e){alert("Something went Problom!"),console.log(e)}),e.handleCancel(),t.preventDefault()},e.handleInvite=function(t){if(""==e.state.inviteDisplayName||""==e.state.inviteUserEmail)alert("Please fill the fields");else{e.state.inviteUserEmail;E()({method:"POST",url:"https://graph.microsoft.com/v1.0/invitations",headers:{Authorization:"Bearer "+e.state.access_token,"Content-Type":"application/json"},data:{invitedUserDisplayName:e.state.inviteDisplayName,invitedUserEmailAddress:e.state.inviteUserEmail,sendInvitationMessage:!0,inviteRedirectUrl:"https://iot.dhl.com/",inviteRedeemUrl:"https://iot.dhl.com/"}}).then(function(e){console.log(e),201===e.status&&alert("Invitation sent Successfully")}).catch(function(e){console.log(e)}),e.handleCancel(),t.preventDefault()}},e.checkEmail=function(){var t=e.state.inviteUserEmail;if(/^\w+([\.-]?\w+)*@\w+([\.-]?\w+)*(\.\w{2,3})+$/.test(t)){var a="?$filter=startswith(mail, '"+t+"')";E()({method:"get",url:"https://graph.microsoft.com/v1.0/users"+a,headers:{Authorization:"Bearer "+e.state.access_token,"Content-Type":"application/json"}}).then(function(t){console.log(t),1==t.data.value.length?(alert("Already registered Please try again with another email"),e.setState({inviteOk:!0,inviteUserEmail:""})):e.setState({inviteOk:!1})}).catch(function(e){console.log(e),alert("Something Went wrong, Please try again later")})}else alert("Not a Valid Email Address"),e.setState({inviteOk:!0})},e.checkName=function(){var t=e.state.inviteDisplayName;1==/[ !@#$%^&*()_+\-=\[\]{};':"\\|,.<>\/?]/.test(t)?(alert("Not a valid name"),e.setState({inviteDisplayName:null})):console.log("Ok!")},e.state={users:[],visible:!1,value:"",name:"",lastname:"",mail:"",phone:"",search:"",inviteModel:0,inviteDisplayName:"",inviteUserEmail:"",access_token:"eyJ0eXAiOiJKV1QiLCJub25jZSI6IkFRQUJBQUFBQUFEQ29NcGpKWHJ4VHE5Vkc5dGUtN0ZYMEJHdjFhakVNVlVBWlh1V0Y3ckE4SS1WSTBkbkE4bHVKeHZRU3NHcWZSRWczUlk5LV9uc2NKNEY5RDh1MWdCb1RoNTY4OU5uVndMNC14SERzb3A3WUNBQSIsImFsZyI6IlJTMjU2IiwieDV0IjoiSEJ4bDltQWU2Z3hhdkNrY29PVTJUSHNETmEwIiwia2lkIjoiSEJ4bDltQWU2Z3hhdkNrY29PVTJUSHNETmEwIn0.eyJhdWQiOiJodHRwczovL2dyYXBoLm1pY3Jvc29mdC5jb20iLCJpc3MiOiJodHRwczovL3N0cy53aW5kb3dzLm5ldC9jZDk5ZmVmOC0xY2QzLTRhMmEtOWJkZi0xNTUzMTE4MWQ2NWUvIiwiaWF0IjoxNTU3NzI2MTQxLCJuYmYiOjE1NTc3MjYxNDEsImV4cCI6MTU1NzczMDA0MSwiYWlvIjoiNDJaZ1lHQXhhUHpQK0svUzdieXlJdmN1ZjczTkFBPT0iLCJhcHBfZGlzcGxheW5hbWUiOiJESExJT1RDb21tb25BcHAiLCJhcHBpZCI6ImRlMjE1ODhmLTBkYzAtNDEzMy04NTMwLTIyNDQzY2E1ZWFkZCIsImFwcGlkYWNyIjoiMSIsImlkcCI6Imh0dHBzOi8vc3RzLndpbmRvd3MubmV0L2NkOTlmZWY4LTFjZDMtNGEyYS05YmRmLTE1NTMxMTgxZDY1ZS8iLCJvaWQiOiJkOWQwMzcxYy1lN2NlLTRhM2EtYjQ3YS1iN2VjNmNmNmY2OGEiLCJyb2xlcyI6WyJVc2VyLlJlYWRXcml0ZS5BbGwiLCJEaXJlY3RvcnkuUmVhZFdyaXRlLkFsbCIsIlVzZXIuSW52aXRlLkFsbCIsIlVzZXIuUmVhZC5BbGwiXSwic3ViIjoiZDlkMDM3MWMtZTdjZS00YTNhLWI0N2EtYjdlYzZjZjZmNjhhIiwidGlkIjoiY2Q5OWZlZjgtMWNkMy00YTJhLTliZGYtMTU1MzExODFkNjVlIiwidXRpIjoiT3g3NVdiNUFGRUdfcUZEMmwwWXRBQSIsInZlciI6IjEuMCIsInhtc190Y2R0IjoxNDA5OTA4MTc0fQ.IAbifxwQFG17ekWvER5ZoCuf_AYbCXpmkpV3NCiWu6oOJK9zyXEF6TjYacbubSApO0ADXxf3Wi4RBvlhTlq0b12IIVyivS4WuGCJzWfx1owceExIX_gaAPVo7PuKR1q7w8wIa1JKxW7d9l_H7hL2ylSfsDTqcasref8SMAU3vD6u-3rv3Nlwd-AMTvuIYOF9OrfEVN8elqFiK7kStThh0CyL9lzR5a9y4RTOtJhngTOOH2kYkK5LyDuPbGE6Wky05FSpxVqyyfG5DMm-zdK2myqRmheZG-CVnpOjxNS-8jDxjkfrjbb0sabnrSjwwIgdFRENCaORq7v0ZqIq4RxB2Q",inviteOk:!0,nexLink:null},e.handleChange=e.handleChange.bind(Object(v.a)(e)),e.handleSubmit=e.handleSubmit.bind(Object(v.a)(e)),e.handleUpdate=e.handleUpdate.bind(Object(v.a)(e)),e}return Object(h.a)(t,e),Object(o.a)(t,[{key:"componentWillMount",value:function(){this.fetchAccessToken()}},{key:"render",value:function(){var e=this,t=this.state.users;return l.a.createElement("div",{className:"body-container"},l.a.createElement("div",{className:"header-container"},l.a.createElement("img",{style:{paddingLeft:"4%"},alt:"logo",src:"https://iot.dhl.com/assets/images/dhl_logo.png"}),l.a.createElement("div",{style:{textAlign:"center",width:"73%"}},l.a.createElement("h1",null,"B2B APP"))),l.a.createElement("div",{className:"body1 col-md-12"},l.a.createElement("div",{className:"col-md-12"},l.a.createElement("div",{className:"col-md-8"},l.a.createElement("div",{className:"serachuser col-md-8"},l.a.createElement(C,{placeholder:"Search users by mail or name",enterButton:"Search",size:"large",value:this.state.search,onChange:this.handleChange,name:"search",onSearch:function(t){return e.handleSubmit(t)}})),l.a.createElement("button",{onClick:this.fetchDetails,onAnimationEnd:!0,class:"ui button design"},"Clear Search")),l.a.createElement("div",{className:"col-md-4"},l.a.createElement("div",{className:"invitebutton"},l.a.createElement(f.a,{type:"primary",onClick:function(t){return e.showModal("","invite")}},"Invite User")))),l.a.createElement("div",{className:"col-md-12 datatable"},l.a.createElement(b.a,{celled:!0},l.a.createElement(b.a.Header,null,l.a.createElement(b.a.Row,null,l.a.createElement(b.a.HeaderCell,null,"Display Name"),l.a.createElement(b.a.HeaderCell,null,"Mail"),l.a.createElement(b.a.HeaderCell,null,"Business Phones"),l.a.createElement(b.a.HeaderCell,null,"Job Title"),l.a.createElement(b.a.HeaderCell,null,"Action"))),l.a.createElement(b.a.Body,null,t.map(function(t,a){return l.a.createElement(b.a.Row,null,l.a.createElement(b.a.Cell,null,t.displayName),l.a.createElement(b.a.Cell,null,t.userPrincipalName),l.a.createElement(b.a.Cell,null,t.businessPhones[0]),l.a.createElement(b.a.Cell,null,t.jobTitle),l.a.createElement(b.a.Cell,null,l.a.createElement(f.a,{onClick:function(){return e.showModal(t)}}," Update ")))})),l.a.createElement(b.a.Footer,null)))),0==this.state.inviteModel?l.a.createElement(g.a,{title:"Update user details",visible:this.state.visible,onOk:function(t){return e.handleUpdate(t)},onCancel:this.handleCancel},l.a.createElement("form",{onSubmit:this.handleUpdate},l.a.createElement(N.a,{type:"text",value:this.state.name,name:"name",onChange:this.handleChange,placeholder:"Name"}),l.a.createElement("br",null),l.a.createElement(N.a,{type:"text",value:this.state.lastname,name:"lastname",onChange:this.handleChange,placeholder:"Last Name"}),l.a.createElement("br",null),l.a.createElement(N.a,{type:"text",disabled:!0,value:this.state.mail,name:"mail",onChange:this.handleChange,placeholder:"Mail"}),l.a.createElement("br",null),l.a.createElement(N.a,{type:"text",value:this.state.phone,name:"phone",onChange:this.handleChange,placeholder:"Mobile Phone"}))):l.a.createElement(g.a,{title:"Invite External User",visible:this.state.visible,onOk:function(t){return e.handleInvite(t)},onCancel:this.handleCancel,okButtonProps:{disabled:this.state.inviteOk},okText:"INVITE"},l.a.createElement("form",null,l.a.createElement(N.a,{type:"text",value:this.state.inviteDisplayName,required:!0,name:"invitename",onBlur:this.checkName,onChange:this.handleChange,placeholder:"Name"}),l.a.createElement("br",null),l.a.createElement(N.a,{type:"email",value:this.state.inviteUserEmail,required:!0,onBlur:this.checkEmail,name:"invitemail",onChange:this.handleChange,placeholder:"Mail"}))))}}]),t}(n.Component),y=a(36),S=(a(422),N.a.Search,{"Content-Type":"application/json"}),I=function(e){function t(){var e;return Object(c.a)(this,t),(e=Object(r.a)(this,Object(m.a)(t).call(this))).handleChange=function(t){var a=t.target,n=a.name,l=a.value;"nickname"===n&&e.setState({nickname:l}),"firstname"===n&&e.setState({firstname:l}),"email"===n&&e.setState({email:l}),"phone"===n&&e.setState({phone:l}),"lastname"===n&&e.setState({lastname:l})},e.handleSubmit=function(t){console.log(e.state),""==e.state.firstname||""==e.state.email||""==e.state.phone||""==e.state.nickname?alert("Please fill all the fields"):E()({method:"POST",url:"https://dhlcp-b2b-externaluserappservice.azurewebsites.net/api/inviteguest",headers:S,data:{firstname:e.state.firstname,lastname:e.state.lastname,email:e.state.email,phone:e.state.phone,nickname:e.state.nickname}}).then(function(t){console.log(t),200===t.status&&(alert("Invitation sent Successfully"),e.setState({firstname:"",lastname:"",email:"",phone:"",nickname:""}))}).catch(function(e){alert("Something went Problom!"),console.log(e)})},e.state={nickname:"",lastname:"",firstname:"",phone:"",email:""},e}return Object(h.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){return l.a.createElement("div",{className:"body-container"},l.a.createElement("div",{className:"header-container"},l.a.createElement("img",{style:{paddingLeft:"4%"},alt:"logo",src:"https://iot.dhl.com/assets/images/dhl_logo.png"}),l.a.createElement("div",{style:{textAlign:"center",width:"73%"}},l.a.createElement("h1",null,"B2B GUEST USER REGISTARTION APP"))),l.a.createElement("div",{className:"body1 col-md-12"},l.a.createElement("div",{className:"col-md-12 datatable"},l.a.createElement("div",{className:"col-md-6 userdiv"},l.a.createElement("div",{className:"col-md-12 inputdiv"},l.a.createElement("div",{className:"col-md-4 leftdiv"},l.a.createElement("label",null,"First Name")),l.a.createElement("div",{className:"col-md-8 rightdiv"},l.a.createElement(N.a,{name:"firstname",value:this.state.firstname,onChange:this.handleChange,placeholder:"Enter firstname"}))),l.a.createElement("div",{className:"col-md-12 inputdiv"},l.a.createElement("div",{className:"col-md-4 leftdiv"},l.a.createElement("label",null,"Nick Name")),l.a.createElement("div",{className:"col-md-8 rightdiv"},l.a.createElement(N.a,{name:"nickname",value:this.state.nickname,onChange:this.handleChange,placeholder:"Enter nickname"}))),l.a.createElement("div",{className:"col-md-12 inputdiv"},l.a.createElement("div",{className:"col-md-4 leftdiv"},l.a.createElement("label",null,"Email")),l.a.createElement("div",{className:"col-md-8 rightdiv"},l.a.createElement(N.a,{name:"email",value:this.state.email,onChange:this.handleChange,placeholder:"Enter Email",type:"email"}))),l.a.createElement("div",{className:"col-md-12 inputdiv"},l.a.createElement("div",{className:"col-md-4 leftdiv"},l.a.createElement("label",null,"Phone")),l.a.createElement("div",{className:"col-md-8 rightdiv"},l.a.createElement(N.a,{name:"phone",value:this.state.phone,onChange:this.handleChange,placeholder:"Enter phone",type:"number"}))),l.a.createElement("div",{className:"col-md-12 inputdiv"},l.a.createElement(y.a,{type:"primary",style:{width:"40%"},onClick:this.handleSubmit},"Register Now"))))))}}]),t}(n.Component),w=(a(423),function(e){function t(){return Object(c.a)(this,t),Object(r.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){return l.a.createElement("div",null,l.a.createElement(u.a,null,l.a.createElement(d.c,null,l.a.createElement(d.a,{exact:!0,path:"/admin",component:k})),l.a.createElement(d.a,{exact:!0,path:"/",component:I})))}}]),t}(n.Component));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(l.a.createElement(w,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[232,1,2]]]);
//# sourceMappingURL=main.a7f9eea7.chunk.js.map